---
# defaults file for ansible-role-deployment-automation

# Desired deployment state for the role. Supported values: present, absent.
state: present

# MetalLB configuration for the mgmt cluster.
helm_binary_path:   # "{{ role_path }}/files/helm-wrapper.py"  # Fix for Helm 4 compatibility with kubernetes.core.helm module.

mgmt_cluster_metallb_namespace: metallb-system
mgmt_cluster_metallb_ipaddresspools: []
mgmt_cluster_metallb_ip_pool_name: mgmt-cluster-pool
mgmt_cluster_metallb_ip_pool_size: 50
mgmt_cluster_metallb_ip_pool_tail_reserve: 2
podman_kind_network_name: kind
mgmt_cluster_metallb_l2advertisements:
  - name: mgmt-cluster
    ipAddressPools:
      - "{{ mgmt_cluster_metallb_ip_pool_name }}"

# Helm release defaults for the mgmt cluster Zabbix deployment.
mgmt_cluster_zabbix_release_name: zabbix
mgmt_cluster_zabbix_namespace: zabbix
mgmt_cluster_zabbix_helm_timeout: 600s
mgmt_cluster_zabbix_chart_server_image_tag: ubuntu-7.0.16

# Consolidated PostgreSQL access defaults for the Zabbix chart.
mgmt_cluster_zabbix_postgres_access:
  existingSecretName: ""
  secretHostKey: host
  secretPortKey: port
  secretUserKey: user
  secretPasswordKey: password
  secretDBKey: dbname
  secretSchemaKey: ""
  host: "zabbix-postgresql"
  port: "5432"
  user: "zabbix"
  password: "zabbix"
  database: "zabbix"
  schema: ""

# Zabbix server service exposure defaults.
mgmt_cluster_zabbix_server_service:
  type: LoadBalancer
  clusterIP: null
  externalIPs: []
  loadBalancerIP: ~
  loadBalancerSourceRanges: []
  loadBalancerClass: ""
  sessionAffinity: None
  port: 10051
  nodePort: 31051
  annotations: {}

# Zabbix web service exposure defaults for the mgmt cluster.
mgmt_cluster_zabbix_web_service:
  type: LoadBalancer
  clusterIP: null
  externalIPs: []
  loadBalancerIP: ~
  loadBalancerSourceRanges: []
  loadBalancerClass: ""
  sessionAffinity: None
  port: 80
  nodePort: 31080
  annotations: {}

# Load balancer discovery defaults for the mgmt cluster Zabbix server service.
mgmt_cluster_zabbix_server_service_name: "{{ mgmt_cluster_zabbix_release_name }}-zabbix-server"
mgmt_cluster_zabbix_server_lb_wait_retries: 30
mgmt_cluster_zabbix_server_lb_wait_delay: 10

# Load balancer discovery defaults for the mgmt cluster Zabbix web service.
mgmt_cluster_zabbix_web_service_name: "{{ mgmt_cluster_zabbix_release_name }}-zabbix-web"
mgmt_cluster_zabbix_web_lb_wait_retries: 30
mgmt_cluster_zabbix_web_lb_wait_delay: 10

# Reverse proxy exposure for Zabbix web UI.
zabbix_web_reverse_proxy_enabled: true
zabbix_web_reverse_proxy_host_port: 8123
zabbix_web_reverse_proxy_listen_port: 8080
zabbix_web_reverse_proxy_container_name: zabbix-web-proxy
zabbix_web_reverse_proxy_image: nginx:stable-alpine
zabbix_web_reverse_proxy_network: "{{ podman_kind_network_name }}"
zabbix_web_reverse_proxy_config_dir: "{{ ansible_env.HOME | default('/tmp') }}/.local/share/ansible-role-deployment-automation"
zabbix_web_reverse_proxy_extra_args: []
zabbix_web_reverse_proxy_target_scheme: http
zabbix_web_reverse_proxy_target_port: "{{ mgmt_cluster_zabbix_web_service.port | default(80) }}"

# Embedded PostgreSQL chart defaults for the Zabbix deployment.
mgmt_cluster_zabbix_postgresql:
  enabled: true
  image:
    repository: postgres
    tag: 16
    pullPolicy: IfNotPresent
    pullSecrets: []
  resources: {}
  persistence:
    enabled: false
    existingClaimName: false
    storageSize: 5Gi
  service:
    type: ClusterIP
    clusterIP: null
    port: 5432
    annotations: {}
  extraRuntimeParameters:
    max_connections: 100
  extraEnv: []
  extraStatefulSetAnnotations: {}
  extraStatefulSetLabels: {}
  extraPodAnnotations: {}
  extraPodLabels: {}
  extraVolumeMounts: []
  extraContainers: []
  extraInitContainers: []
  extraVolumes: []
  extraPodSpecs: {}
  securityContext: {}
  livenessProbe: {}
  readinessProbe: {}
  startupProbe: {}
  nodeSelector: {}

# Helm release defaults for the infra cluster Zabbix proxy deployment.
infra_cluster_zabbix_proxy_release_name: zabbix-proxy
infra_cluster_zabbix_proxy_namespace: zabbix-proxy
infra_cluster_zabbix_proxy_helm_timeout: 600s
infra_cluster_zabbix_proxy_image_tag: ubuntu-7.0.16
infra_cluster_zabbix_proxy_mode: 0
infra_cluster_zabbix_proxy_hostname: zabbix-proxy
infra_cluster_zabbix_proxy_server_port: 10051
infra_cluster_zabbix_proxy_values_overrides: {}

# Zabbix API credential management defaults.
mgmt_cluster_zabbix_admin_username: Admin
mgmt_cluster_zabbix_admin_password: zabbix
mgmt_cluster_zabbix_api_initial_username: "{{ mgmt_cluster_zabbix_admin_username }}"
mgmt_cluster_zabbix_api_initial_password: "{{ mgmt_cluster_zabbix_admin_password }}"
mgmt_cluster_zabbix_api_user_groups:
  - Zabbix administrators
mgmt_cluster_zabbix_api_role_name: ~
mgmt_cluster_zabbix_api_manage_user: true

# Zabbix API connectivity defaults.
zabbix_api_host: ~
zabbix_api_port: ~
zabbix_api_use_ssl: false
zabbix_api_url_path: ""
zabbix_api_path: api_jsonrpc.php
zabbix_api_validate_certs: "{{ zabbix_api_use_ssl | bool }}"
zabbix_api_wait_retries: 60
zabbix_api_wait_delay: 10
zabbix_api_endpoint_override: ~
zabbix_api_wait_for_ready: true

# Zabbix proxy registration defaults.
infra_cluster_zabbix_proxy_registration_enabled: true
infra_cluster_zabbix_proxy_registration_name: ~
infra_cluster_zabbix_proxy_registration_description: ~
infra_cluster_zabbix_proxy_registration_operating_mode: ~
infra_cluster_zabbix_proxy_registration_state: present
infra_cluster_zabbix_proxy_registration_params: {}

# SNMP workload defaults for simulated monitored devices.
snmpd_user: snmpv3user
snmpd_auth_pass: ChangeMeAuthPass
snmpd_priv_pass: ChangeMePrivPass
snmpd_syslocation: DemoLab
snmpd_syscontact: ops@example.com
snmpd_listen_port: 1161
snmpd_listen_endpoint: "udp:{{ snmpd_listen_port }}"
snmpd_template_path: /usr/local/share/snmp/snmpd.conf.template
snmpd_config_path: /etc/snmp/snmpd.conf
snmpd_image_repository: zabbix-snmpd
snmpd_image_tag: kind
snmpd_image_registry: docker.io
snmpd_image_archive: zabbix-snmpd-kind.tar
snmpd_kind_cluster_name: "{{ infra_cluster_name | default('infra-cluster') }}"
snmpd_image_cleanup_archive: true
snmpd_namespace: snmp-sim
snmpd_app_name: snmpd
snmpd_deployment_name: snmpd
snmpd_service_name: snmpd
snmpd_replicas: 3
snmpd_service_type: ClusterIP
snmpd_service_port: 161
snmpd_pod_annotations: {}
snmpd_pod_labels: {}
snmpd_service_annotations: {}
snmpd_statefulset_name: "{{ snmpd_deployment_name }}"
snmpd_headless_service_name: "{{ snmpd_service_name }}-headless"
snmpd_pod_service_prefix: "{{ snmpd_service_name }}"
snmpd_pod_service_annotations: {}
snmpd_node_selector: {}
snmpd_tolerations: []
snmpd_affinity: {}
snmpd_extra_env: []
snmpd_resources: {}
snmpd_secret_name: snmpd-credentials
snmpd_secret_mount_path: /run/snmpd-credentials
snmpd_secret_annotations: {}
snmpd_secret_labels: {}
snmpd_secret_keys:
  user: user
  auth_pass: auth-pass
  priv_pass: priv-pass
snmpd_force_rollout_restart: true

# Zabbix SNMP host registration defaults.
infra_cluster_zabbix_snmp_host_registration_enabled: true
infra_cluster_zabbix_snmp_host_groups:
  - Simulated SNMP Devices
infra_cluster_zabbix_snmp_templates:
  - Linux by SNMP
infra_cluster_zabbix_snmp_tags: []
infra_cluster_zabbix_snmp_macros: []
infra_cluster_zabbix_snmp_security_name: "{{ snmpd_user }}"
infra_cluster_zabbix_snmp_security_level: 2
infra_cluster_zabbix_snmp_auth_protocol: 1
infra_cluster_zabbix_snmp_auth_passphrase: "{{ snmpd_auth_pass }}"
infra_cluster_zabbix_snmp_priv_protocol: 1
infra_cluster_zabbix_snmp_priv_passphrase: "{{ snmpd_priv_pass }}"
infra_cluster_zabbix_snmp_version: 3
infra_cluster_zabbix_snmp_bulk: 1
infra_cluster_zabbix_snmp_monitored_by: proxy
infra_cluster_zabbix_snmp_host_status: enabled
